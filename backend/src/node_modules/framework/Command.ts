const exec = require("child_process").exec;

import {MakeUtil} from "framework/Util";

export interface ICommand {
    cleanUpTmpDirectory(): void;
}

export function MakeCommand() {
    return new Command();
}

export class Command implements ICommand {

    public cleanUpTmpDirectory() {
        const dir = MakeUtil().tmpDirectory;
        const cmd = `find ${dir} -mtime +1 -exec rm -f {} \\;`;
        run(cmd);
    }

}

export function run(cmd: string) {
    return new Promise(function (resolve: any, reject: any) {
        exec(cmd, function(err: any, stdout: any) {
            if (err) {
                reject(err);
            }
            resolve("COMMAND EXEC DONE");
        });
    });
}
